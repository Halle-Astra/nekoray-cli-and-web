# NekoRay CLI å¿«é€Ÿå‚è€ƒ

## ğŸ¯ é¡¹ç›®ç®€ä»‹
å°† NekoRay (v2rayN) æ”¹é€ ä¸ºæ”¯æŒ CLI å’Œ Web çš„æ— å¤´ Linux V2Ray å®¢æˆ·ç«¯ï¼Œå®Œæ•´ä¿ç•™ TUN åŠŸèƒ½ã€‚

## ğŸ“ æ ¸å¿ƒæ–‡ä»¶ç»“æ„
```
nekoray_cli/
â”œâ”€â”€ nekoray/core/                 # æ ¸å¿ƒæœåŠ¡å±‚
â”‚   â”œâ”€â”€ NekoService_Fixed.cpp     # ä¸»æœåŠ¡ç±» (æ— å¤´æ¶æ„)
â”‚   â”œâ”€â”€ CoreManager_Fixed.cpp     # ä»£ç†æ ¸å¿ƒç®¡ç†
â”‚   â”œâ”€â”€ TunManager_Fixed.cpp      # TUN æ¨¡å¼ç®¡ç†
â”‚   â”œâ”€â”€ ConfigManager.cpp         # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ SafetyUtils.cpp           # å®‰å…¨æ£€æŸ¥å·¥å…·
â”œâ”€â”€ nekoray/cli/                  # CLI æ¥å£
â”‚   â””â”€â”€ main_cli.cpp              # å‘½ä»¤è¡Œç•Œé¢
â”œâ”€â”€ nekoray/web/                  # Web æ¥å£  
â”‚   â””â”€â”€ WebApiServer.cpp          # REST API + åµŒå…¥å¼ç•Œé¢
â””â”€â”€ DEVELOPMENT_LOG.md            # è¯¦ç»†å¼€å‘è®°å½•
```

## ğŸ”§ å…³é”®ä¿®å¤è®°å½•

| é—®é¢˜ç±»å‹ | ä½ç½® | ä¿®å¤çŠ¶æ€ | è¯´æ˜ |
|---------|------|---------|------|
| æ¶æ„ä¾èµ– | `NekoService_Fixed.cpp:114+` | âœ… å·²ä¿®å¤ | ç§»é™¤ `NekoGui::dataStore` å…¨å±€ä¾èµ– |
| ä¿¡å·è¿æ¥ | `CoreManager_Fixed.cpp:78-79` | âœ… å·²ä¿®å¤ | ä¿®æ­£ Signal/Slot è¿æ¥è¯­æ³• |
| å¤´æ–‡ä»¶ | `NekoService_Fixed.cpp:1` | âœ… å·²ä¿®å¤ | ä¿®æ­£åŒ…å«è·¯å¾„ |
| å…¨å±€ä¾èµ– | `ConfigManager.cpp:2` | âœ… å·²ä¿®å¤ | ç§»é™¤ NekoGui åŒ…å« |

## ğŸ§ª æµ‹è¯•éªŒè¯

**å¿«é€ŸéªŒè¯å‘½ä»¤**ï¼š
```bash
cd build_test
./critical_issues_test     # å…³é”®é—®é¢˜æ£€æŸ¥
./test_architecture        # æ¶æ„æµ‹è¯•  
./test_core_logic          # æ ¸å¿ƒé€»è¾‘æµ‹è¯•
./final_verification_report # å®Œæ•´éªŒè¯æŠ¥å‘Š
```

**é¢„æœŸç»“æœ**: æ‰€æœ‰æµ‹è¯•åº”æ˜¾ç¤º `âœ… PASSED`

## ğŸš€ ä½¿ç”¨æ–¹æ³•

**CLI æ¨¡å¼**:
```bash
# åŸºç¡€ä½¿ç”¨
./nekoray-cli start --profile 1
./nekoray-cli start --profile 1 --tun  # TUN æ¨¡å¼
./nekoray-cli stop
./nekoray-cli status

# å®‰å…¨æ¨¡å¼
./nekoray-cli start --dry-run           # æµ‹è¯•æ¨¡å¼ï¼Œä¸å®é™…æ‰§è¡Œ
```

**Web API**:
```bash
# å¯åŠ¨ Web æœåŠ¡
./nekoray-web --port 8080

# API è°ƒç”¨ç¤ºä¾‹
curl http://localhost:8080/api/status                    # è·å–çŠ¶æ€
curl -X POST http://localhost:8080/api/start \          # å¯åŠ¨ä»£ç†
     -d '{"profile_id":1, "tun_mode":true}'
```

## ğŸ—ï¸ æ„å»ºæŒ‡å—

**ä¾èµ–å®‰è£…**:
```bash
# Ubuntu/Debian
sudo apt install qt6-base-dev cmake build-essential

# æˆ–æœ€å°ä¾èµ–
sudo apt install qt6-base-dev-tools libqt6core6-dev libqt6network6-dev
```

**ç¼–è¯‘æ­¥éª¤**:
```bash
mkdir build && cd build
cmake ..
make -j$(nproc)
```

## ğŸ” æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLIå®¢æˆ·ç«¯    â”‚    â”‚ Webç•Œé¢     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
             â”‚      â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
      â”‚   NekoService      â”‚  â† æ ¸å¿ƒæœåŠ¡ (æ— GUIä¾èµ–)
      â”‚  (æ— å¤´æ¶æ„)        â”‚
      â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
        â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚CoreManager â”‚    â”‚TunManager  â”‚  â† è¿›ç¨‹ç®¡ç†å±‚
â”‚(ä»£ç†æ ¸å¿ƒ)  â”‚    â”‚(TUNæ¨¡å¼)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚
        â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     sing-box/nekobox-core       â”‚  â† åº•å±‚ä»£ç†æ ¸å¿ƒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ è´¨é‡æ£€æŸ¥æ¸…å•

### ä»£ç è´¨é‡ âœ…
- [x] æ—  `NekoGui::` å…¨å±€ä¾èµ–
- [x] æ­£ç¡®çš„ Qt Signal/Slot è¿æ¥
- [x] è‡ªåŒ…å«é…ç½®ç®¡ç†  
- [x] å®Œæ•´çš„é”™è¯¯å¤„ç†

### æ¶æ„ä¸€è‡´æ€§ âœ…  
- [x] `NekoCore` å‘½åç©ºé—´éš”ç¦»
- [x] QObject ç»§æ‰¿å…³ç³»æ­£ç¡®
- [x] æ¥å£è®¾è®¡ä¸€è‡´

### åŠŸèƒ½å®Œæ•´æ€§ âœ…
- [x] CLI æ¥å£å®ç°
- [x] Web API å®ç°  
- [x] TUN æ¨¡å¼æ”¯æŒ
- [x] é…ç½®ç®¡ç†ç³»ç»Ÿ

### å®‰å…¨æœºåˆ¶ âœ…
- [x] Docker ç¯å¢ƒæ£€æµ‹
- [x] SSH è¿æ¥æ„ŸçŸ¥
- [x] å¹²è¿è¡Œæ¨¡å¼
- [x] æƒé™æå‡å¤„ç†

## ğŸ› é—®é¢˜æ’æŸ¥

**å¸¸è§é—®é¢˜**:

1. **ç¼–è¯‘é”™è¯¯**: æ£€æŸ¥ Qt6 æ˜¯å¦æ­£ç¡®å®‰è£…
2. **ä¿¡å·è¿æ¥å¤±è´¥**: ç¡®è®¤ä½¿ç”¨æ§½å‡½æ•°è€Œéä¿¡å·
3. **TUN æ¨¡å¼å¤±è´¥**: æ£€æŸ¥æƒé™å’Œ pkexec å¯ç”¨æ€§  
4. **é…ç½®åŠ è½½å¤±è´¥**: ç¡®è®¤é…ç½®ç›®å½•æƒé™

**è°ƒè¯•å‘½ä»¤**:
```bash
# æ£€æŸ¥ä¾èµ–
./critical_issues_test

# è¯¦ç»†æ—¥å¿—
./nekoray-cli start --profile 1 --verbose

# æµ‹è¯•æ¨¡å¼
./nekoray-cli start --dry-run
```

## ğŸ“ å¼€å‘è§„èŒƒ

**æ–‡ä»¶å‘½å**:
- ä¿®å¤æ–‡ä»¶ä½¿ç”¨ `*_Fixed.cpp` åç¼€
- æ–°åŠŸèƒ½æ–‡ä»¶ç›´æ¥å‘½åï¼Œé¿å…å†²çª

**ä»£ç è§„èŒƒ**:
- ä½¿ç”¨ `NekoCore` å‘½åç©ºé—´
- ç»§æ‰¿ `QObject` æ”¯æŒä¿¡å·/æ§½
- æˆå‘˜å˜é‡ä½¿ç”¨ `m_` å‰ç¼€
- ç§æœ‰æ–¹æ³•ä½¿ç”¨å°å†™å¼€å¤´

**æäº¤è§„èŒƒ**:
```
ç±»å‹: ç®€çŸ­æè¿°

è¯¦ç»†è¯´æ˜ (å¯é€‰)

ä¿®å¤: #issue_number (å¦‚æœæœ‰)
```

## ğŸ“ æ”¯æŒä¸ç»´æŠ¤

**æ–‡æ¡£æ›´æ–°**: ä»»ä½•é‡è¦æ›´æ”¹éƒ½éœ€è¦åŒæ­¥æ›´æ–° `DEVELOPMENT_LOG.md`

**ç‰ˆæœ¬ç®¡ç†**: 
- ä¸»ç‰ˆæœ¬: æ¶æ„é‡å¤§å˜æ›´
- æ¬¡ç‰ˆæœ¬: æ–°åŠŸèƒ½æ·»åŠ 
- è¡¥ä¸ç‰ˆæœ¬: Bug ä¿®å¤

**å½“å‰çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ªï¼Œæ‰€æœ‰å…³é”®é—®é¢˜å·²ä¿®å¤

---
**å¿«é€Ÿå‚è€ƒç‰ˆæœ¬**: 1.0.0 | **æ›´æ–°æ—¶é—´**: 2025-11-15